<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
    <head>
        <title>Your First Brick of leJOS (for Mac OSX)</title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <meta NAME="Author" CONTENT="Matthias Paul Scholz">
        <meta name="expires" content="0">
        <link rel="stylesheet" type="text/css" href="../../tutorial.css">
    </head>

    <body>

        <!-- navigation header -->
        <b><font SIZE="-1">The leJOS Tutorial</font></b>
        <br>
        <table width="550">
            <tr>
                <td align="left" valign="center">
                    <a href="linux.html" target="_top"><img src="../../images/previous.gif" align="center" border="0" alt="Previous Page"></a>
                    <a href="../toc.html#firstbrick" target="_top"><img src="../../images/toc.gif" align="center" border="0" alt="Lesson Contents"></a>
                    <a href="../whatislejos.html" target="_top"><img src="../../images/next.gif" align="center" border="0" alt="Next Page"></a></td>

                <td align="center" valign="center">
                    <font size="-1">
                    <a href="../../index.html" target="_top">Start of Tutorial</a>
                    &gt;
                    <a href="../index.html" target="_top">Start of Trail</a>
                    </font>
                </td>
            </tr>
        </table>
        <!-- end navigation header -->
        <hr>

        <font size="-1">
            <b>Trail</b>: Getting Started<br>
            <b>Lesson</b>: Your First Brick of leJOS
        </font>

        <!-- headline -->
        <h1>Your First Brick of leJOS  (for Mac OSX)</h1>
        <p>

        The following instructions, which refer to the Macintosh OSX platform,
        will help you to run your first leJOS program.<br>
        It is based on Mr. Kusako's notes in the readme.osx file,
        the contributions of <a href="http://math.cudenver.edu/~aperez/lejos/index.html">
        Adolfo Perez</a> and the leJOS FAQ section.
        <br>
        You are encouraged to <a href="http://lejos.sourceforge.net/faq.html">consult the latter</a>
        when required.
        <p>
        leJOS is known to work with MAC OSX, version 10.1.3 and up, and Mac OSX 2.6 with USB.
        <p>
        We presume that you are familiar with the Java language on an elementary level at least.
        If this is not the case, we encourage you to consult the first trails of the 
        <a href="http://java.sun.com/docs/books/tutorial/index.html">The Java Tutorial</a>
        provided by <em>Sun Microsystems</em>.
        <p>
        Besides the <b>LEGO MINDSTORMS RCX</b>, the associated <b>IR Tower</b>
        and the leJOS environment (see below), you will need:
        <ul>
            <li>
                <b>The Java<sup><font size=-2>TM</font></sup> 2 Platform, Standard Edition.</b>
                <br>
                Note: if there's a Java SDK installed on your machine already, 
                you may use it - any version from 1.1 to 1.4 will work.
            </li>
        </ul>
        That's all you need except for the leJOS environment.
        
        <!-- reminder -->
        <h2>Some words on Serial and USB support</h2>
        leJOS is known to work with OS X and a serial tower.
        However as current MACs don't have a serial interface you need a USB to serial converter with 
        OS X driver support to attach a LEGO serial IR tower to your MAC. 
        
        <br>
        See the leJOS FAQ (<a href="<http://lejos.sourceforge.net/faq/">http://lejos.sourceforge.net/faq/</a>)
        for more information.
        <p>
        As for USB support, please note this <br>
        <b>WARNING!
        This version contains experimental support for USB on MAC OS X.<br>
        While it works on some MACs, it doesn't mean that it couldn't damage your RCX, tower or even your MAC.
        <br>
        So use completely at your own risk!
        </b>
        <br>
        After all, on Mac OSX 2.6 leJOS was run successfully with a USB tower.
 
        <!-- download -->
        <h2>Download of the leJOS environment</h2>
        You can find the actual version of the leJOS environment from the
        <a href="http://lejos.sourceforge.net/download.html">Download section of 
        http://www.lejos.org</a>.

        <!-- installation -->
        <h2>Installation of the leJOS environment</h2>
        <ol>
            <li>
                After you have downloaded the leJOS environment tar file, untar it to an arbitrary directory:
                <br><code>tar -xzf lejos_2_1_0.tar.gz</code>
                </li>
            <li>
                Open a shell and change to the directory you installed leJOS into. 
            </li>
            <li>
                Open Terminal.app and create a text file that will contain all the 
                following environment settings by typing
                <br><code>pico lejos.env</code>.
            </li>
            <li>
                Add the SDK's bin directory to your <b>PATH</b> environment variable.
            </li>
            <li>
                Set the <b>LEJOS_HOME</b> evironment variable to the directory you installed lejos into:<br>
                <code>setenv LEJOS_HOME < your lejos directory ></code>   
            </li>
            <li>
                Add leJOS's bin directory to your <b>PATH</b> environment variable:<br>
                <code>setenv PATH {$PATH}:${LEJOS_HOME}/bin</code>
            </li>
            <li>
                Add leJOS's bin directory to your <b>DYLD_LIBRARY_PATH</b> environment variable:<br>
                <code>if (! $?DYLD_LIBRARY_PATH) setenv DYLD_LIBRARY_PATH<br>
                setenv DYLD_LIBRARY_PATH ${DYLD_LIBRARY_PATH}:${LEJOS_HOME}/bin</code>
            </li>
            <li>
                Add the leJOS classes to your <b>CLASSPATH</b> environment variable:<br>
                <code>if (! $?CLASSPATH) setenv CLASSPATH<br>
                setenv CLASSPATH ${CLASSPATH}:.:${LEJOS_HOME}/lib</code>                
            </li>
            <li>
                Set the <b>RCXTTY</b> environment variable to your serial 'tower' 
                device:<br>
                <code>setenv RCXTTY /dev/cu.YOUR_SERIAL_PORT</code> 
                <br>or, in case of usage of an USB tower, set it to
                <br><code>setenv RCXTTY usb</code>
            </li>
            <li>
                Save and close the textfile and run it using
                <br><code>source lejos.env</code>    
            </li>
            <li>
                Type <br><code>make</code>
                <br>If you experience linker related error messages such as 
                "Undefined symbol", try using <b>gcc 2.X</b> instead of <b>gcc 3.x</b>,
                which seems to have problems finding <code>libgcc.a<code>:
                <br><code>gcc_select 2</code>
                <br><code>make</code>
                <br>
                It might also be useful to disable making of the rcxcomm subpackage 
                sources in the makefile.
            </li>
       </ol>

        <!-- firmware -->
        <h2>leJOS-enable your RCX</h2>
        To enable your RCX for the execution of leJOS programs, you will have to replace the original 
        LEGO<sup>&reg;</sup> with the leJOS operating system. This is easily done:
        <ol>
            <li>Place the IR sensor of the RCX in front of the IR Tower</li>
            <li>Turn on the RCX</li>
            <li>Open a shell and change to the <code>bin</code> 
                directory of your leJOS installation</li>
            <li>call <code>firmdl</code> </li>
            <li>the progress of the download is displayed in the command shell and on the display of the
            RCX; the RCX will double beep when the download is complete and display the battery voltage</li>
        </ol>

        <span class="remark">
                Alternatively you may use the older C-based tool <code>lejosfirmdl</code> instead of the 
                Java-based <code>firmdl</code> (available since leJOS 2.0.1).
        </span>
        <p>

        If the download doesn't work, make sure that
        <ul> 
            <li>your RCX is turned on</li>
            <li>your RCX's IR port (the dark panel on the front) is facing towards the IR tower</li> 
            <li>your RCXTTY environment variable is set accordingly</li> 
        </ul>
        The tower should blink green, when you start <code>firmdl</code>.
        <p>

       <span class="remark">
                The original LEGO<sup>&reg;</sup> firmware isn't deleted from the RCX, but stored away. 
                Hence you may re-activate it by just removing the batteries
		for some minutes and replacing it.<br>
		The leJOS firmware will be lost in this case, though, and will
		have to be downloaded again to be useable on the RCX.
                <br>Note that you have to install the leJOS firmware only once
		(unless removing the batteries); 
                nevertheless it may be downloaded as often as you wish, but the leJOS programs
                you have installed will be lost in this case.
        </span>
   
                
        
        <!-- hello world -->
        <h2>Create and Run your first leJOS program</h2>
        There's a simple "Hello World" style example program available in the <em>examples\hworld</em> 
        section of the leJOS tree:
        <pre><code>
            import josx.platform.rcx.*;

            /**
             * @author <a mailto="rvbijl39<at>calvin<dot>edu">Ryan VanderBijl</a>
             */

            /* This class uses char[] to display text on the LCD.
             * Strings aren't really supported by TinyVM. :-(
             * 
             * This program, after d/ling, waits for you to press the RUN
             * button, and then displays "hello", for a small delay, and then
             * displays "world". (Then a small delay, and then it returns to
             * the TinyVM OS).
             */

            public class HelloWorld
            {
              public static void main (String[] aArg)
              throws Exception
              {
                 LCD.clear();
                 TextLCD.print ("hello");
                 Thread.sleep(2000);
                 TextLCD.print ("world");
                 Thread.sleep(2000);
              }
            }
        </code></pre>
        <p>
        To run this program, you will: 
        <ol>
            <li>Open a shell and change to the <code>examples\hworld</code> 
                directory of your leJOS installation</li>
            <li>Compile it using <code>lejosjc</code> instead of <code>javac</code>:<br>
                <code>lejosjc HelloWorld.java</code>
            </li>
            <li>Create a binary file containing the linked program with 
                <code>lejoslink -o HelloWorld.bin HelloWorld</code></li>
            <li>Download it to the RCX using <code>lejosdl</code>:<br>
                <code>lejosdl HelloWorld.bin</code>
            </li>
            <li>the progress of the download is displayed in the command shell and on the display of the
            RCX; the RCX will double beep when the download is complete and displays a standing man</li>
            <li>Press Run to start the program; The words "hello" and afterwards "world" will be displayed
            on the RCX</li>
        </ol>
        If <code>lejosjc</code> or <code>lejosdl</code> isn't found, make sure your PATH variable is set accordingly.
        <br>If the leJOS classes arent found, check your CLASSPATH variable.
        <p>

        <span class="remark">
            The two steps of linking and downloading may be done in one with <br>                   
                <code>lejoslink HelloWorld</code>
            <br>Alternatively you may use the older C-based tools 
            <code>lejosc</code> (for compiling) and <code>lejos</code> for linking 
            and downloading.
            <br>You can also download multiple programs in one shot as follows:<br>
            <code>lejosdl Bin1,Bin2,...</code>
            <br>
            The programs will be linked together, and will replace
            any programs previously in the RCX. You can press the <b>Prgm</b> button
            to select which program to run.
        </span>
        <p>

        <b>Congratulations! You have run your first leJOS program on your RCX.</b>

        <h2>Troubleshooting</h2>
        One of the steps above did not work for you? A look into the <a href="../problems.html">Common problems</a>
        section might help.
        <p>
        Yet, if it doesn't, feel free to post your question to the <a href="http://lists.sourceforge.net/lists/listinfo/lejos-discussion">lejos discussion list</a>. 

        <hr>
        <!-- navigation footer -->
        <b><font SIZE="-1">The leJOS Tutorial</font></b>
        <br>
        <table width="550">
            <tr>
                <td align="left" valign="center">
                    <a href="linux.html" target="_top"><img src="../../images/previous.gif" align="center" border="0" alt="Previous Page"></a>
                    <a href="../toc.html#firstbrick" target="_top"><img src="../../images/toc.gif" align="center" border="0" alt="Lesson Contents"></a>
                    <a href="../whatislejos.html" target="_top"><img src="../../images/next.gif" align="center" border="0" alt="Next Page"></a></td>

                <td align="center" valign="center">
                    <font size="-1">
                    <a href="../../index.html" target="_top">Start of Tutorial</a>
                    &gt;
                    <a href="../index.html" target="_top">Start of Trail</a>
                    </font>
                </td>
            </tr>
        </table>
        <!-- end navigation footer -->
</body>

</html>
